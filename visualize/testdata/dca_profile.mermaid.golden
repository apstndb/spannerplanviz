%%{ init: {"theme": "default",
           "themeVariables": { "wrap": "false" },
           "flowchart": { "curve": "linear",
                          "markdownAutoWrap":"false",
                          "wrappingWidth": "600" }
           }
}%%
graph TD
    node0["<b>Distributed Cross Apply</b><br/>Split Range: ($SingerId_1 = $SingerId)<br/>execution_method: Row<br/><i>Number of Batches: 1 batches</i><br/><i>cpu_time: 376.8 msecs</i><br/><i>latency: 1.08 secs</i><br/><i>remote_calls: 0 calls</i><br/><i>rows: 3069 rows</i><br/><i>execution_summary:<br/>&nbsp;&nbsp;&nbsp;checkpoint_time: 0.28 msecs<br/>&nbsp;&nbsp;&nbsp;execution_end_timestamp: 2025-06-06T20:52:18.231573Z<br/>&nbsp;&nbsp;&nbsp;execution_start_timestamp: 2025-06-06T20:52:17.148944Z<br/>&nbsp;&nbsp;&nbsp;num_checkpoints: 19<br/>&nbsp;&nbsp;&nbsp;num_executions: 1</i>"]
    style node0 text-align:left;
    node1["<b>Create Batch</b><br/>execution_method: Row<br/>$v2.Batch:=$v1"]
    style node1 text-align:left;
    node2["<b>Compute Struct</b><br/>execution_method: Row<br/>$v1.BirthDate:=$BirthDate<br/>$v1.FirstName:=$FirstName<br/>$v1.LastName:=$LastName<br/>$v1.SingerId:=$SingerId<br/>$v1.SingerInfo:=$SingerInfo<br/><i>cpu_time: 31.2 msecs</i><br/><i>latency: 79.04 msecs</i><br/><i>rows: 1000 rows</i><br/><i>execution_summary:<br/>&nbsp;&nbsp;&nbsp;checkpoint_time: 0.01 msecs<br/>&nbsp;&nbsp;&nbsp;num_checkpoints: 1<br/>&nbsp;&nbsp;&nbsp;num_executions: 1</i>"]
    style node2 text-align:left;
    node3["<b>Distributed Union</b><br/>Split Range: true<br/>distribution_table: Singers<br/>execution_method: Row<br/>split_ranges_aligned: false<br/><i>cpu_time: 30.2 msecs</i><br/><i>latency: 78.03 msecs</i><br/><i>remote_calls: 0 calls</i><br/><i>rows: 1000 rows</i><br/><i>execution_summary:<br/>&nbsp;&nbsp;&nbsp;checkpoint_time: 0.01 msecs<br/>&nbsp;&nbsp;&nbsp;num_checkpoints: 1<br/>&nbsp;&nbsp;&nbsp;num_executions: 1</i>"]
    style node3 text-align:left;
    node4["<b>Local Distributed Union</b><br/>execution_method: Row<br/><i>cpu_time: 29.97 msecs</i><br/><i>latency: 77.8 msecs</i><br/><i>remote_calls: 0 calls</i><br/><i>rows: 1000 rows</i><br/><i>execution_summary:<br/>&nbsp;&nbsp;&nbsp;checkpoint_time: 0.01 msecs<br/>&nbsp;&nbsp;&nbsp;execution_end_timestamp: 2025-06-06T20:52:17.228881Z<br/>&nbsp;&nbsp;&nbsp;execution_start_timestamp: 2025-06-06T20:52:17.14899Z<br/>&nbsp;&nbsp;&nbsp;num_checkpoints: 1<br/>&nbsp;&nbsp;&nbsp;num_executions: 1</i>"]
    style node4 text-align:left;
    node5["<b>Table Scan</b><br/>Table: Singers<br/>Full scan: true<br/>execution_method: Row<br/>scan_method: Automatic<br/>$SingerId:=SingerId<br/>$FirstName:=FirstName<br/>$LastName:=LastName<br/>$SingerInfo:=SingerInfo<br/>$BirthDate:=BirthDate<br/><i>cpu_time: 29.84 msecs</i><br/><i>deleted_rows: 0@0±0 rows</i><br/><i>filesystem_delay_seconds: 48.16@24.08±24.08 msecs</i><br/><i>filtered_rows: 0@0±0 rows</i><br/><i>latency: 77.66 msecs</i><br/><i>rows: 1000 rows</i><br/><i>scanned_rows: 1000@500±500 rows</i><br/><i>execution_summary:<br/>&nbsp;&nbsp;&nbsp;checkpoint_time: 0 msecs<br/>&nbsp;&nbsp;&nbsp;num_checkpoints: 1<br/>&nbsp;&nbsp;&nbsp;num_executions: 1</i>"]
    style node5 text-align:left;
    node18["<b>Serialize Result</b><br/>Result.SingerId:$batched_SingerId<br/>Result.FirstName:$batched_FirstName<br/>Result.LastName:$batched_LastName<br/>Result.SingerInfo:$batched_SingerInfo<br/>Result.BirthDate:$batched_BirthDate<br/>Result.AlbumId:$AlbumId<br/>Result.TrackId:$TrackId<br/>Result.SongName:$SongName<br/>Result.Duration:$Duration<br/>Result.SongGenre:$SongGenre<br/>execution_method: Row<br/><i>cpu_time: 342.95 msecs</i><br/><i>latency: 998.11 msecs</i><br/><i>rows: 3069 rows</i><br/><i>execution_summary:<br/>&nbsp;&nbsp;&nbsp;checkpoint_time: 0.18 msecs<br/>&nbsp;&nbsp;&nbsp;execution_end_timestamp: 2025-06-06T20:52:18.231497Z<br/>&nbsp;&nbsp;&nbsp;execution_start_timestamp: 2025-06-06T20:52:17.229908Z<br/>&nbsp;&nbsp;&nbsp;num_checkpoints: 19<br/>&nbsp;&nbsp;&nbsp;num_executions: 1</i>"]
    style node18 text-align:left;
    node19["<b>Cross Apply</b><br/>execution_method: Row<br/><i>cpu_time: 341.43 msecs</i><br/><i>latency: 996.58 msecs</i><br/><i>rows: 3069 rows</i><br/><i>execution_summary:<br/>&nbsp;&nbsp;&nbsp;checkpoint_time: 0.17 msecs<br/>&nbsp;&nbsp;&nbsp;num_checkpoints: 19<br/>&nbsp;&nbsp;&nbsp;num_executions: 1</i>"]
    style node19 text-align:left;
    node20["<b>KeyRangeAccumulator</b><br/>execution_method: Row<br/><i>cpu_time: 0.62 msecs</i>"]
    style node20 text-align:left;
    node21["<b>Batch Scan</b><br/>Batch: $v2<br/>execution_method: Row<br/>scan_method: Row<br/>$batched_BirthDate:=BirthDate<br/>$batched_FirstName:=FirstName<br/>$batched_LastName:=LastName<br/>$batched_SingerId:=SingerId<br/>$batched_SingerInfo:=SingerInfo"]
    style node21 text-align:left;
    node27["<b>Local Distributed Union</b><br/>execution_method: Row<br/><i>cpu_time: 340.03@0.34±0.06 msecs</i><br/><i>latency: 995.19@1±8.12 msecs</i><br/><i>remote_calls: 0@0±0 calls</i><br/><i>rows: 3069@3.07±1.72 rows</i><br/><i>execution_summary:<br/>&nbsp;&nbsp;&nbsp;checkpoint_time: 0.16 msecs<br/>&nbsp;&nbsp;&nbsp;num_checkpoints: 19<br/>&nbsp;&nbsp;&nbsp;num_executions: 1000</i>"]
    style node27 text-align:left;
    node28["<b>Filter Scan</b><br/>Residual Condition: ($SongName LIKE 'Th%e')<br/>execution_method: Row<br/>seekable_key_size: 0"]
    style node28 text-align:left;
    node29["<b>Table Scan</b><br/>Table: Songs<br/>Seek Condition: ($SingerId_1 = $batched_SingerId)<br/>execution_method: Row<br/>scan_method: Row<br/>$SingerId_1:=SingerId<br/>$AlbumId:=AlbumId<br/>$TrackId:=TrackId<br/>$SongName:=SongName<br/>$Duration:=Duration<br/>$SongGenre:=SongGenre<br/><i>cpu_time: 339.21@0.34±0.06 msecs</i><br/><i>deleted_rows: 0 rows</i><br/><i>filesystem_delay_seconds: 521.29 msecs</i><br/><i>filtered_rows: 1020931 rows</i><br/><i>latency: 994.3@0.99±8.12 msecs</i><br/><i>rows: 3069@3.07±1.72 rows</i><br/><i>scanned_rows: 1024000 rows</i><br/><i>execution_summary:<br/>&nbsp;&nbsp;&nbsp;checkpoint_time: 0.05 msecs<br/>&nbsp;&nbsp;&nbsp;num_checkpoints: 19<br/>&nbsp;&nbsp;&nbsp;num_executions: 1000</i>"]
    style node29 text-align:left;
    node0 -->|Input| node1
    node1 --> node2
    node2 --> node3
    node3 -.-> node4
    node4 --> node5
    node0 -.->|Map| node18
    node18 --> node19
    node19 -->|Input| node20
    node20 --> node21
    node19 -->|Map| node27
    node27 --> node28
    node28 --> node29
